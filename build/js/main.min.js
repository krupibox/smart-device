"use strict";!function(){var t=document.querySelector("body"),e=t.querySelector(".inner"),a=e.querySelector(".overlay"),l=e.querySelector(".modal"),o=e.querySelector(".button"),r=l.querySelector("img"),n=e.querySelector(".modal__form"),c=t.querySelector(".form:not(.modal__form)"),s=n.querySelector("#modal-form-name"),m=n.querySelector("#modal-form-phone"),u=n.querySelector("#modal-form-questions"),i=c.querySelector("#form-name"),d=c.querySelector("#form-phone"),f=c.querySelector("#form-questions"),v={mask:"+{7} (000) 000-00-00"},y=IMask(m,v),S=IMask(d,v);y.updateValue(),S.updateValue();var g=!0;try{s.value=localStorage.getItem("formName")}catch(e){g=!1}function q(e){Array.from(e.querySelectorAll("input:not([type=checkbox]), textarea")).forEach(function(e){e.value=""}),window.localStorage.clear(),e.reset()}function L(e){e.preventDefault(),t.classList.remove("noscroll"),l.classList.add("modal--closed"),a.style.display="none"}g&&(i.value=localStorage.getItem("formName"),d.value=localStorage.getItem("formPhone"),f.value=localStorage.getItem("formQuestions")),o.addEventListener("click",function(e){e.preventDefault(),l.classList.contains("modal--closed")&&(l.classList.remove("modal--closed"),t.classList.add("noscroll"),a.style.display="block",g&&(s.value=localStorage.getItem("modalFormName"),m.value=localStorage.getItem("modalFormPhone"),u.value=localStorage.getItem("modalFormQuestions")),s.value?m.focus():s.focus(),s.value&&m.value&&u.focus()),n.addEventListener("change",function(){g&&(localStorage.setItem("modalFormName",s.value),localStorage.setItem("modalFormPhone",m.value),localStorage.setItem("modalFormQuestions",u.value))});var o=n.querySelector("input[name=modal-acceptance]");o.setCustomValidity("Согласитесь на обработку персональных данных"),o.addEventListener("change",function(){o.validity.valueMissing||o.setCustomValidity("")}),n.addEventListener("submit",function(){q(n)})}),c.addEventListener("change",function(){g&&(localStorage.setItem("formName",i.value),localStorage.setItem("formPhone",d.value),localStorage.setItem("formQuestions",f.value))}),c.addEventListener("submit",function(){q(c)}),r.addEventListener("click",function(e){l.classList.contains("modal--closed")||L(e)}),a.addEventListener("click",function(e){l.classList.contains("modal--closed")||e.target!==a||L(e)}),window.addEventListener("keydown",function(e){27!==e.keyCode||l.classList.contains("modal--closed")||L(e)})}();